<!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" >

<web-app xmlns:beans="http://www.springframework.org/schema/beans">
  <display-name>Archetype Created Web Application</display-name>
  <filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
  <global-method-security pre-post-annotations="enabled" />

  <http pattern="/api/login" security="none"/>
  <http pattern="/api/signup" security="none"/>

  <http pattern="/api/**" entry-point-ref="restAuthenticationEntryPoint" create-session="stateless">
    <csrf disabled="true"/>
    <custom-filter before="FORM_LOGIN_FILTER" ref="jwtAuthenticationFilter"/>
  </http>

  <beans:bean id="jwtAuthenticationFilter" class="com.toptal.travelplanner.security.JwtAuthenticationFilter">
    <beans:property name="authenticationManager" ref="authenticationManager" />
    <beans:property name="authenticationSuccessHandler" ref="jwtAuthenticationSuccessHandler" />
  </beans:bean>

  <authentication-manager alias="authenticationManager">
    <authentication-provider ref="jwtAuthenticationProvider" />
  </authentication-manager>
</web-app>
